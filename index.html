<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Моя Визитка</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.cdnfonts.com/css/minecraftia" rel="stylesheet">
</head>
<body oncontextmenu="return false;" oncopy="return false;" ondragstart="return false;" ondrop="return false;" onselectstart="return false;">
    <audio id="menuMusic" loop>
        <source src="audio/menu_music.mp3" type="audio/mpeg">
        Браузер не любит музычку :(
    </audio>
    <audio id="buttonSound" src="audio/button_click.mp3" preload="auto"></audio>
    <audio id="foxButtonSound" src="audio/fox_button_click.mp3" preload="auto"></audio>
    <audio id="doYouLoveMe" src="audio/doyouloveme.mp3" preload="auto"></audio>
    <audio id="idle" src="audio/idle.mp3" preload="auto"></audio> <!-- Убрала loop, чтоб 'ended' работал! -->
    <audio id="doYouNeedMe" src="audio/doyouneedme.mp3" preload="auto"></audio>
    <audio id="end" src="audio/end.mp3" preload="auto"></audio>

    <canvas id="confetti_canvas"></canvas>

    <div class="menu-container">
        <div class="title-container">
            <img src="images/logo.png" alt="Моя Визитка" class="title">
            <div id="splash" class="splash tilt"></div>
        </div>
        <div class="buttons">
            <a href="about.html" class="button btn-minecraft" data-page="about">Обо мне</a>
            <a href="contacts.html" class="button btn-minecraft" data-page="contacts">Контакты</a>
            <a href="https://bnd.lc/vinar" class="button btn-minecraft" data-page="music">Моя музыка</a>
            <div class="bottom-buttons">
                <a href="settings.html" class="button btn-minecraft" data-page="settings">Настройки</a>
                <a href="#" class="button btn-minecraft" data-special="exit" aria-label="Выйти"></a>
            </div>
        </div>
    </div>
    <div class="content-section" style="display: none;"></div>

    <div id="blackOverlay" style="display: none;"></div>
    <img id="meImage" src="images/me.png" alt="Me" style="display: none;">
    <div id="modal" style="display: none;">
        <p id="question"></p>
        <button id="yes">Yes</button>
        <button id="no">No</button>
    </div>
    <div id="finalImage" style="display: none;">
        <img id="finalImg" src="images/end_image.png" alt="Final Image">
    </div>

    <div class="version">Версия 1.0</div>
    <div class="copyright">© 2025 vinar. All rights reserved.</div>

    <script type="module">
        import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.168/build/three.module.js';

        let camera, scene, renderer;
        let isInitialized = false;
        window.panoramaSpeed = 0.0003;

        function initPanorama() {
            if (isInitialized) return;
            isInitialized = true;
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(90, window.innerWidth / window.innerHeight, 1, 1000);
            camera.position.set(0, 0, 0);
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.domElement.style.position = 'fixed';
            renderer.domElement.style.top = '0';
            renderer.domElement.style.left = '0';
            renderer.domElement.style.zIndex = '-1';
            renderer.domElement.style.filter = 'blur(10px)';
            document.body.appendChild(renderer.domElement);

            const loader = new THREE.CubeTextureLoader();
            const texture = loader.load([
                'images/panorama_1.png',
                'images/panorama_3.png',
                'images/panorama_4.png',
                'images/panorama_5.png',
                'images/panorama_0.png',
                'images/panorama_2.png'
            ]);
            scene.background = texture;

            window.addEventListener('resize', onWindowResize);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            camera.rotation.y -= window.panoramaSpeed;
            renderer.render(scene, camera);
        }

        initPanorama();
        animate();
    </script>

    <script src="script.js"></script>
</body>
</html>